<!-- contain for single book info -->
<div class="container">
  <div class="row">
    <div class="col-md-3 col-sm-3">
      <!-- book cover thumbnail -->
      <img class="thumbnail" src="{{ getThumbnail(displayBook) }}" />
      <!-- buttons for adding to list and seeing reviews -->
      <div class="listButtons">
        <!-- add displayed book to favorites button -->
        <button
          class="iconButton"
          *ngIf="loggedIn && !CheckIfInFavoriteList(displayBook)"
          (click)="addFavorite(displayBook)"
        >
          <span id="icon" class="material-symbols-outlined"> hotel_class </span>
          <br />
          <p class="buttonText">Favorite</p>
        </button>
        <!-- message displayed instead of list add buttons if user is not logged in -->
        <p *ngIf="!loggedIn">Log in to create personalized lists</p>
        <!-- add displayed book to wishlist button -->
        <button
          class="iconButton"
          *ngIf="loggedIn && !CheckIfInWishList(displayBook)"
          (click)="addToWishList(displayBook)"
        >
          <span id="icon" class="material-symbols-outlined"> menu_book </span>
          <br />
          <p class="buttonText">Wish List</p>
        </button>
        <!-- add displayed book to readlist button -->
        <button
          class="iconButton"
          *ngIf="loggedIn && !CheckIfInReadList(displayBook)"
          (click)="addToReadList(displayBook)"
        >
          <span id="icon" class="material-symbols-outlined">
            bookmark_added
          </span>
          <br />
          <p class="buttonText">Already Read</p>
        </button>
        <!-- add displayed book to denied list button -->
        <button
          class="iconButton"
          *ngIf="loggedIn && !CheckIfInDeniedList(displayBook)"
          (click)="addToDeniedList(displayBook)"
        >
          <span id="icon" class="material-symbols-outlined"> dangerous </span>
          <br />
          <p class="buttonText">Uninterested</p>
        </button>
        <!-- button that toggles display for reviews of displayed book -->
        <button
          *ngIf="!showReviews"
          class="iconButton"
          (click)="toggleReviews()"
        >
          <span id="icon" class="material-symbols-outlined"> visibility </span>
          <br />
          <p class="buttonText">Show Reviews</p>
        </button>
        <button
          *ngIf="showReviews"
          class="iconButton"
          (click)="toggleReviews()"
        >
          <span id="icon" class="material-symbols-outlined">
            visibility_off
          </span>
          <br />
          <p class="buttonText">Hide Reviews</p>
        </button>
      </div>
    </div>

    <div class="col-md-8 col-sm-8">
      <!-- holds all info for displayed book -->
      <div class="bookInfo">
        <h1>{{ displayBook.volumeInfo.title }}</h1>
        <h2>Categories: {{ displayBook.volumeInfo.categories }}</h2>
        <h3>Author(s): {{ displayBook.volumeInfo.authors }}</h3>
        <h6>{{ displayBook.volumeInfo.description }}</h6>
        <p>Page Count: {{ displayBook.volumeInfo.pageCount }}</p>
        <p *ngIf="displayBook.volumeInfo.ratingsCount != undefined">
          Average Rating: {{ displayBook.volumeInfo.averageRating }}/5
          &nbsp;&nbsp; Number of Ratings:
          {{ displayBook.volumeInfo.ratingsCount }}
        </p>
        <p *ngIf="displayBook.volumeInfo.ratingsCount == undefined">
          Rating not available
        </p>
        <p>
          Published by {{ displayBook.volumeInfo.publisher }} on
          {{ displayBook.volumeInfo.publishedDate }}
        </p>
      </div>
    </div>
  </div>
</div>

<!-- display that holds buttons and reviews -->
<div *ngIf="showReviews" class="container">
  <div class="col-md-12 col-sm-12">
    <!-- container that holds buttons for review interactions -->
    <div class="reviewButtonContainer">
      <!-- button that brings up form over page to write a review -->
      <button *ngIf="loggedIn" class="iconButton" (click)="toggleReviewForm()">
        <span id="icon" class="material-symbols-outlined"> history_edu </span>
        <br />
        <p class="buttonText">Write a Review</p>
      </button>
      <!-- button that displays reviews by most recent(default view) -->
      <button class="iconButton" (click)="getReviews()">
        <span id="icon" class="material-symbols-outlined">
          nest_clock_farsight_analog
        </span>
        <br />
        <p class="buttonText">Most Recent</p>
      </button>
      <!-- button for ordering reviews by most upvotes -->
      <button class="iconButton" (click)="getTopReviews()">
        <span id="icon" class="material-symbols-outlined">
          local_fire_department
        </span>
        <br />
        <p class="buttonText">Top Voted</p>
      </button>
    </div>

    <!-- black screen image appears behind write review form to block page -->
    <div *ngIf="showReviewForm" class="layer2">
      <img src="../../assets/background.png" id="bg" />
    </div>

    <!-- container that holds all reviews for displayed book -->
    <div *ngIf="showReviews">
      <!-- loops through all reviews of displayed book -->
      <div *ngFor="let r of reviews">
        <!-- container that holds an individual review of displayed book -->
        <div class="review">
          <!-- displays review info and text -->
          <h6>{{ r.userName }}</h6>
          <h6>{{ r.bookTitle }} by {{ r.author }}</h6>
          <h6>{{ formatReviewDate(r.datePosted) }}</h6>
          <p>{{ r.review1 }}</p>
          <p>Votes: {{ r.votes }}</p>
          <!-- button that upvotes review -->
          <button class="iconButton" *ngIf="loggedIn" (click)="Upvote(r)">
            <span id="icon" class="material-symbols-outlined"> thumb_up </span>
            <br />
            <p class="buttonText">Upvote</p>
          </button>
          <!-- button that downvotes review -->
          <button class="iconButton" *ngIf="loggedIn" (click)="Downvote(r)">
            <span id="icon" class="material-symbols-outlined">
              thumb_down
            </span>
            <br />
            <p class="buttonText">Downvote</p>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- form for writing a review, floats above page  -->
<div *ngIf="showReviewForm" class="layer3">
  <div class="reviewForm">
    <!-- on submit the review is posted and the form disappears -->
    <form #Submit="ngForm" (ngSubmit)="PostReview(Submit); toggleReviewForm()">
      <!-- button to close form without submitting review -->
      <button class="iconButton closeFormButton" (click)="toggleReviewForm()">
        <span id="icon" class="material-symbols-outlined"> close </span>
      </button>
      <!-- displays review writer and book review is being written for -->
      <h6 class="reviewFormText">{{ user.name }}</h6>
      <h6 class="reviewFormText">
        Write a review for {{ displayBook.volumeInfo.title }} by
        {{ displayBook.volumeInfo.authors }}
      </h6>
      <!-- label for review text input -->
      <label class="reviewFormText" for="review" name="review" id="review"
        >Review:</label
      >
      <br />
      <!-- text area for user to type review text -->
      <textarea name="review" ngModel></textarea>
      <!-- button to submit the review form -->
      <button class="reviewFormButton">Post Review</button>
    </form>
  </div>
</div>
